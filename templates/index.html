<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pronóstico de Producción</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    h1 { color: #2c3e50; }
    button { padding: 0.5rem 1rem; font-size: 1rem; cursor: pointer; }
    table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: center; }
    th { background-color: #f5f5f5; }
    #result { margin-top: 1rem; }
  </style>
</head>
<body>
  <h1>Pronóstico de Producción</h1>
  <button id="btn-forecast">Obtener Pronóstico</button>
  <div id="result"></div>

  <script>
    document.getElementById('btn-forecast').addEventListener('click', async () => {
      const resultDiv = document.getElementById('result');
      resultDiv.textContent = 'Cargando...';
      try {
        const response = await fetch('/forecast');
        if (!response.ok) throw new Error('Error al obtener pronóstico');
        const csv = await response.text();
        const lines = csv.trim().split('\n');
        const headers = lines[0].split(',');
        const table = document.createElement('table');
        // Encabezado
        const thead = document.createElement('thead');
        const trHead = document.createElement('tr');
        headers.forEach(h => {
          const th = document.createElement('th'); th.textContent = h; trHead.appendChild(th);
        });
        thead.appendChild(trHead);
        table.appendChild(thead);
        // Cuerpo
        const tbody = document.createElement('tbody');
        lines.slice(1).forEach(line => {
          const tr = document.createElement('tr');
          line.split(',').forEach(cell => {
            const td = document.createElement('td'); td.textContent = cell; tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
        table.appendChild(tbody);
        resultDiv.innerHTML = '';
        resultDiv.appendChild(table);
      } catch (err) {
        resultDiv.textContent = err.message;
      }
    });
  </script>
</body>
</html>
